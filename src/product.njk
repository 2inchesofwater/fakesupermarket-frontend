<!-- src/product.njk -->
---
layout: base.njk
pagination:
  data: products
  size: 1
  alias: product
permalink: "product/{{ product.id }}/"
eleventyComputed:
  title: "{{ product.name }}"
---

<div class="product-detail">
  <div class="product-images">
    <div class="main-image">
      <img src="{{ product.image }}" alt="{{ product.name }}" class="product-image">
    </div>
    
    {% if product.gallery and product.gallery.length %}
      <div class="product-gallery">
        {% for image in product.gallery %}
          <div class="gallery-thumbnail">
            <img src="{{ image }}" alt="{{ product.name }}" class="thumbnail-image">
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
  
  <div class="product-info">
    <h1 class="product-title">{{ product.name }}</h1>
    
    <div class="product-pricing">
      {% if product.on_sale %}
        <div class="price-container">
          <span class="original-price">${{ product.price | toFixed(2) }}</span>
          <span class="sale-price">${{ product.sale_price | toFixed(2) }}</span>
          
          {% if product.discount_label %}
            <span class="discount-badge">{{ product.discount_label }}</span>
          {% endif %}
        </div>
      {% else %}
        <span class="regular-price">${{ product.price | toFixed(2) }}</span>
      {% endif %}
    </div>
    
    <div class="product-description">
      {{ product.description }}
    </div>
    
    <div class="product-meta">
      <div class="product-availability">
        {% if product.stock > 0 %}
          <span class="in-stock">In Stock ({{ product.stock }} available)</span>
        {% else %}
          <span class="out-of-stock">Out of Stock</span>
        {% endif %}
      </div>
      
      <div class="product-category">
        <span>Category:</span> 
        <a href="/products?category={{ product.category }}">{{ product.category | capitalize }}</a>
      </div>
    </div>
    
    <div class="product-actions">
      <div class="quantity-selector">
        <label for="quantity">Quantity</label>
        <select id="quantity" class="quantity-select">
          {% for i in range(1, (product.stock | default(10) | min(10)) + 1) %}
            <option value="{{ i }}">{{ i }}</option>
          {% endfor %}
        </select>
      </div>
      
      <button 
        class="button button-primary"
        data-product-id="{{ product.id }}"
        data-action="add-to-cart"
        {% if product.stock <= 0 %}disabled{% endif %}>
        Add to Cart
      </button>
    </div>
  </div>
</div>